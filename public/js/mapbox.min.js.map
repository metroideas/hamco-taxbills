{"version":3,"sources":["mapbox.js"],"names":["map","window","bounds","mapboxgl","accessToken","Map","container","style","fitBounds","addControl","NavigationControl","update","location","appraisal","taxbills","median","filter","d","year","d3","format","this","flyTo","center","coordinates","zoom","old","document","getElementById","parentNode","removeChild","marker","createElement","id","current","census","censusBlockGroup","zipcode","html","popup","Popup","offset","setHTML","Marker","setLngLat","setPopup","addTo"],"mappings":"AAAA,GAAIA,KAAMC,OAAOD,SAEjB,WAEE,GAAIE,MAAW,UAAW,aAAY,UAAW,WAkEjD,OAhEAC,UAASC,YAAc,mGAEvBJ,IAAM,GAAIG,UAASE,KACfC,UAAW,MACXC,MAAO,2DAGXP,IAAIQ,UAAUN,GACdF,IAAIS,WAAW,GAAIN,UAASO,mBAK5BV,IAAIW,OAAS,SAASC,GAmBpB,QAASC,GAAUC,GACjB,GAAIC,GAASD,EAASE,OAAO,SAASC,GACpC,MAAiB,QAAVA,EAAEC,OACR,GAAGL,UAAUE,MAEhB,OAAOI,IAAGC,OAAO,MAAML,GAtBzBM,KAAKC,OACHC,OAAQX,EAASY,YACjBC,KAAM,IAIR,IAAIC,GAAMC,SAASC,eAAe,SAE9BF,IACFA,EAAIG,WAAWC,YAAYJ,EAI7B,IAAIK,GAASJ,SAASK,cAAc,MACpCD,GAAOE,GAAK,QAYZ,IAAIC,GAAUrB,EAAUD,EAASE,UAC7BqB,EAAUtB,EAAUD,EAASwB,iBAAiBtB,UAC9CuB,EAAUxB,EAAUD,EAASyB,QAAQvB,UAGrCwB,EAAO,6CAEYJ,EAAU,2BACLC,EAAS,6BACPE,EAAU,aAIpCE,EAAQ,GAAIpC,UAASqC,OAAOC,QAAS,GAAG,MACzCC,QAAQJ,EAGX,IAAInC,UAASwC,OAAOZ,GACjBa,UAAUhC,EAASY,aACpBqB,SAASN,GACRO,MAAMzB,OAGJrB,KACNA","file":"mapbox.min.js","sourcesContent":["var map = window.map || {};\n\n(function() {\n  // Map bounds set to SW and NE corners of Hamilton County, Tennessee\n  var bounds = [[-85.475593,34.982924],[-84.942572,35.459261]];\n  // API key\n  mapboxgl.accessToken = 'pk.eyJ1IjoibWRhdmlkbW9ydG9uIiwiYSI6ImNpZzN5cDZyNTI3czJ1c201cjlvMjh4OWQifQ.CGZjS_17LA9FrdS92dMUow';\n  // Set map object\n  map = new mapboxgl.Map({\n      container: 'map',\n      style: 'mapbox://styles/mdavidmorton/ciu5nfp4500eg2ipgdjbmflkw'\n  });\n  // Map settings\n  map.fitBounds(bounds);\n  map.addControl(new mapboxgl.NavigationControl());\n\n  /*\n    map.update expects location data\n  */\n  map.update = function(location) {\n    // Zoom to location coordinates\n    this.flyTo({\n      center: location.coordinates,\n      zoom: 13\n    });\n\n    // Remove any existing markers\n    var old = document.getElementById('marker')\n    \n    if (old) {\n      old.parentNode.removeChild(old);\n    }\n\n    // Add new map marker to DOM\n    var marker = document.createElement('div');\n    marker.id = 'marker';\n\n    // Formats median appraisal string from given taxbills array\n    function appraisal(taxbills) {\n      var median = taxbills.filter(function(d) {\n        return d.year == '2016'\n      })[0].appraisal.median;\n\n      return d3.format(\"$,\")(median); // Requires d3 formatter\n    }\n\n    // Marker popup\n    var current = appraisal(location.taxbills);\n    var census  = appraisal(location.censusBlockGroup.taxbills);\n    var zipcode = appraisal(location.zipcode.taxbills);\n    \n    // Popup HTML\n    var html = '<h4>2016 appraisals</h4>' +\n      '<ul>' +\n        '<li>Location: ' + current + '</li>' +\n        '<li>Census median: ' + census + '</li>' +\n        '<li>ZIP code median: ' + zipcode + '</li>' + \n      '</ul>';\n\n    // Creates popup\n    var popup = new mapboxgl.Popup({offset: [0, -30]})\n      .setHTML(html);\n\n    // Marker placement with popup\n    new mapboxgl.Marker(marker)\n      .setLngLat(location.coordinates)\n     .setPopup(popup)\n      .addTo(this);\n  }\n\n  return map;\n})(map);\n\n\n"],"sourceRoot":"/source/"}